<template>
  <div ref="container" class="controller-container" :style="{ width: controllerWidth+'px', height: controllerHeight+'px' }">
    <div
      class="score-controller"
      :style="{ width: controllerWidth+'px', height: controllerHeight+'px' }">
      <div class="con-slider" ref="slider">
        <div class="process" :style="{width:seekWidth}"></div>
        <div class="thunk" ref="trunk" :style="{left}">
          <div class="btn-circle"></div>
        </div>
      </div>
      <i
        title="播放/暂停"
        style="float: left;margin-left: 20px"
        @click="handlePlay">
        <svg  v-show="playState===0" t="1562724767371" viewBox="0 0 1024 1024" version="1.1"
             xmlns="http://www.w3.org/2000/svg"
             p-id="15263" width="20" height="20">
          <path
            d="M192.01752 181.119321L761.615384 511.99808 192.01752 843.516837V181.119321M119.697791 0A56.319789 56.319789 0 0 0 64.018 58.239782v909.436589a55.039794 55.039794 0 0 0 55.679791 56.319789 58.879779 58.879779 0 0 0 28.799892-7.679971c49.919813-28.159894 740.477223-430.078387 782.717065-455.038294a56.959786 56.959786 0 0 0 0-98.55963L150.417676 8.959966A63.99976 63.99976 0 0 0 119.697791 0z"
            p-id="15264" fill="#ffffff"></path>
        </svg>
        <svg t="1562724858312" v-show="playState===1" viewBox="0 0 1024 1024" version="1.1"
             xmlns="http://www.w3.org/2000/svg"
             p-id="16061" width="20" height="20">
          <path
            d="M686.48 119.56c0-32.377 26.326-58.645 58.645-58.645 32.387 0 58.646 26.421 58.646 58.645v781.93c0 32.377-26.326 58.645-58.646 58.645-32.386 0-58.645-26.42-58.645-58.644V119.56z m-469.159 0c0-32.377 26.326-58.645 58.646-58.645 32.385 0 58.644 26.421 58.644 58.645v781.93c0 32.377-26.325 58.645-58.644 58.645-32.386 0-58.646-26.42-58.646-58.644V119.56z"
            p-id="16062" fill="#ffffff"></path>
        </svg>
      </i>
      <i class="stop-btn" title="停止" style="float: left;margin-left: 20px" @click="handleStop">
        <svg t="1562724967431" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"
             p-id="16847" width="20" height="20">
          <path
            d="M876.892426 153.17758a511.90451 511.90451 0 1 0-6.0641 723.911732 511.90451 511.90451 0 0 0 6.0641-723.911732z m-73.517363 655.277151a415.902726 415.902726 0 1 1 5.079668-588.335792 415.902726 415.902726 0 0 1-5.079668 588.335792z"
            p-id="16848" fill="#ffffff"></path>
          <path
            d="M374.084065 374.359706m78.75454 0l118.13181 0q78.75454 0 78.75454 78.75454l0 118.13181q0 78.75454-78.75454 78.75454l-118.13181 0q-78.75454 0-78.75454-78.75454l0-118.13181q0-78.75454 78.75454-78.75454Z"
            p-id="16849" fill="#ffffff"></path>
        </svg>
      </i>
      <div class="time" style="float: left;margin-left: 20px">
        <span>{{ timeText }}</span>
      </div>
      <i title="全屏" style="float: right;margin-right: 20px"
         @click="handleFullScreen">
        <svg t="1562724300081" v-show="fullState===0" viewBox="0 0 1025 1024" version="1.1"
             xmlns="http://www.w3.org/2000/svg" p-id="10458" width="20" height="20">
          <path
            d="M1014.331575 1013.87659C1009.09925 1020.075757 1001.421383 1024 991.98045 1024L703.975118 1024C686.287587 1024 671.955568 1009.667981 671.955568 991.98045 671.955568 974.292919 686.287587 960.017773 703.975118 960.017773L914.348681 960.984615 569.185893 615.821827 614.4 570.550847 959.9609 916.111747 959.9609 704.031991C959.9609 686.34446 974.292919 672.012441 991.98045 672.012441 1009.611108 672.012441 1023.943127 686.34446 1023.943127 704.031991L1024 991.07048C1024 1000.056429 1020.246376 1008.075535 1014.331575 1013.87659ZM991.98045 352.044432C974.292919 352.044432 959.9609 337.712413 959.9609 320.024882L960.984615 109.651319 615.764954 454.814107 570.550847 409.543127 916.054874 64.0391 703.975118 64.0391C686.287587 64.0391 671.955568 49.707081 671.955568 32.01955 671.955568 14.332019 686.287587 0 703.975118 0L991.07048 0C999.999556 0 1008.075535 3.753624 1013.87659 9.668425 1020.018884 14.90075 1023.943127 22.521744 1023.943127 32.01955L1023.943127 320.024882C1023.943127 337.712413 1009.611108 352.044432 991.98045 352.044432ZM409.543127 453.449153 63.982227 107.888253 63.982227 320.024882C63.982227 337.712413 49.650208 352.044432 32.01955 352.044432 14.332019 352.044432 0 337.712413 0 320.024882L0 32.92952C0 24.000444 3.696751 15.924465 9.611552 10.12341 14.843877 3.924243 22.521744 0 32.01955 0L319.968009 0C337.65554 0 351.987559 14.332019 351.987559 32.01955 351.987559 49.707081 337.65554 64.0391 319.968009 64.0391L109.594446 63.015385 454.814107 408.235046 409.543127 453.449153ZM32.01955 672.012441C49.650208 672.012441 63.982227 686.34446 63.982227 704.031991L63.015385 914.405554 408.178173 569.185893 453.449153 614.456873 107.888253 960.017773 319.968009 960.017773C337.65554 960.017773 351.987559 974.349792 351.987559 991.98045 351.987559 1009.667981 337.65554 1024 319.968009 1024L32.92952 1024C23.943571 1024 15.924465 1020.303249 10.12341 1014.388448 3.924243 1009.09925 0 1001.478256 0 991.98045L0 704.031991C0 686.34446 14.332019 672.012441 32.01955 672.012441Z"
            p-id="10459" fill="#ffffff"></path>
        </svg>
        <svg t="1562724343810" v-show="fullState===1" viewBox="0 0 1024 1024" version="1.1"
             xmlns="http://www.w3.org/2000/svg" p-id="11268" width="20" height="20">
          <path
            d="M397.850624 353.744896V55.148544c0-21.069824-17.098752-38.166528-38.166528-38.166528-21.061632 0-38.160384 17.098752-38.160384 38.166528v215.472128L78.870528 27.89376c-14.272512-14.272512-37.404672-14.272512-51.75296 0-14.272512 14.348288-14.272512 37.480448 0 51.75296L269.84448 322.297856H54.372352c-21.069824 0-38.166528 17.098752-38.166528 38.160384 0 21.069824 17.098752 38.166528 38.166528 38.166528h298.596352c27.858944 0 44.88192-14.348288 44.88192-44.879872zM674.086912 398.624768h298.596352c21.069824 0 38.166528-17.098752 38.166528-38.166528 0-21.061632-17.096704-38.160384-38.166528-38.160384H757.211136L999.936 79.64672c14.272512-14.272512 14.272512-37.404672 0-51.75296-14.348288-14.272512-37.4784-14.272512-51.75296 0L705.533952 270.620672V55.148544c0-21.069824-17.098752-38.166528-38.162432-38.166528-21.069824 0-38.166528 17.098752-38.166528 38.166528v298.596352c0 30.531584 16.9472 44.879872 44.88192 44.879872zM352.968704 627.615744H54.372352c-21.069824 0-38.166528 17.098752-38.166528 38.166528s17.098752 38.166528 38.166528 38.166528H269.84448L27.117568 946.593792c-14.272512 14.272512-14.272512 37.404672 0 51.75296 14.348288 14.272512 37.480448 14.272512 51.75296 0l242.651136-242.726912V971.10016c0 21.06368 17.098752 38.160384 38.160384 38.160384 21.069824 0 38.166528-17.096704 38.166528-38.160384V672.497664c0.002048-30.527488-17.020928-44.88192-44.879872-44.88192zM629.204992 672.497664V971.10016c0 21.06368 17.098752 38.160384 38.166528 38.160384 21.06368 0 38.162432-17.096704 38.162432-38.160384V755.621888L948.18304 998.346752c14.27456 14.272512 37.404672 14.272512 51.75296 0 14.272512-14.348288 14.272512-37.480448 0-51.75296L757.211136 703.950848h215.472128c21.069824 0 38.166528-17.098752 38.166528-38.166528s-17.096704-38.166528-38.166528-38.166528H674.086912c-27.93472-0.002048-44.88192 14.352384-44.88192 44.879872z"
            p-id="11269" fill="#ffffff"></path>
        </svg>
      </i>
      <i title="横竖屏" style="width:23px;height:23px;float: right;margin-right: 20px" @click="handleDirectionChange">
        <svg t="1562723553389" v-show="directionState===1" viewBox="0 0 1024 1024" version="1.1"
             xmlns="http://www.w3.org/2000/svg" p-id="8607">
          <path
            d="M864.711111 955.733333 159.288889 955.733333c-37.705956 0-68.266667-30.560711-68.266667-68.266667L91.022222 455.111111c0-37.705956 30.560711-68.266667 68.266667-68.266667l705.422222 0c37.705956 0 68.266667 30.560711 68.266667 68.266667l0 432.355556C932.977778 925.172622 902.417067 955.733333 864.711111 955.733333zM887.466667 477.866667c0-25.122133-20.388978-45.511111-45.511111-45.511111L182.044444 432.355556c-25.122133 0-45.511111 20.388978-45.511111 45.511111l0 386.844444c0 25.122133 20.388978 45.511111 45.511111 45.511111l659.911111 0c25.122133 0 45.511111-20.388978 45.511111-45.511111L887.466667 477.866667zM796.444444 773.688889c-12.561067 0-22.755556-10.171733-22.755556-22.755556l0-159.288889c0-12.561067 10.194489-22.755556 22.755556-22.755556s22.755556 10.194489 22.755556 22.755556l0 159.288889C819.2 763.517156 809.005511 773.688889 796.444444 773.688889zM887.466667 159.288889c0-25.122133-20.388978-45.511111-45.511111-45.511111L500.622222 113.777778c-25.122133 0-45.511111 20.388978-45.511111 45.511111l0 182.044444-45.511111 0L409.6 136.533333c0-37.705956 30.560711-68.266667 68.266667-68.266667l386.844444 0c37.705956 0 68.266667 30.560711 68.266667 68.266667l0 204.8-45.511111 0L887.466667 159.288889z"
            p-id="8608" fill="#ffffff"></path>
        </svg>
        <svg t="1562723631425" v-show="directionState===0" viewBox="0 0 1024 1024" version="1.1"
             xmlns="http://www.w3.org/2000/svg" p-id="9411">
          <path
            d="M887.466667 932.977778l-204.8 0 0-45.511111 182.044444 0c25.122133 0 45.511111-20.388978 45.511111-45.511111L910.222222 500.622222c0-25.122133-20.388978-45.511111-45.511111-45.511111l-182.044444 0 0-45.511111 204.8 0c37.705956 0 68.266667 30.560711 68.266667 68.266667l0 386.844444C955.733333 902.417067 925.172622 932.977778 887.466667 932.977778zM568.888889 932.977778 136.533333 932.977778c-37.705956 0-68.266667-30.560711-68.266667-68.266667L68.266667 159.288889c0-37.705956 30.560711-68.266667 68.266667-68.266667l432.355556 0c37.705956 0 68.266667 30.560711 68.266667 68.266667l0 705.422222C637.155556 902.417067 606.594844 932.977778 568.888889 932.977778zM591.644444 182.044444c0-25.122133-20.388978-45.511111-45.511111-45.511111L159.288889 136.533333C134.166756 136.533333 113.777778 156.922311 113.777778 182.044444l0 659.911111c0 25.122133 20.388978 45.511111 45.511111 45.511111l386.844444 0c25.122133 0 45.511111-20.388978 45.511111-45.511111L591.644444 182.044444zM432.355556 819.2l-159.288889 0c-12.561067 0-22.755556-10.171733-22.755556-22.755556 0-12.561067 10.194489-22.755556 22.755556-22.755556l159.288889 0c12.561067 0 22.755556 10.194489 22.755556 22.755556C455.111111 809.028267 444.916622 819.2 432.355556 819.2z"
            p-id="9412" fill="#ffffff"></path>
        </svg>
      </i>
      <i title="切换横屏页数" style="margin-top:4px;width:20px;height:23px;float: right;margin-right: 23px" @click="handlePagePerChange">
        <svg t="1562722868053" v-show="pagePerState===1" viewBox="0 0 1126 1024" version="1.1"
             xmlns="http://www.w3.org/2000/svg" p-id="2637">
          <path
            d="M204.8 51.2a153.6 153.6 0 0 0-153.6 153.6v614.4a153.6 153.6 0 0 0 153.6 153.6h716.8a153.6 153.6 0 0 0 153.6-153.6V204.8a153.6 153.6 0 0 0-153.6-153.6H204.8z m0-51.2h716.8a204.8 204.8 0 0 1 204.8 204.8v614.4a204.8 204.8 0 0 1-204.8 204.8H204.8a204.8 204.8 0 0 1-204.8-204.8V204.8a204.8 204.8 0 0 1 204.8-204.8z"
            p-id="2638" fill="#ffffff"></path>
          <path
            d="M421.2736 745.8816h-52.224V433.7664H256v-41.7792c14.7456 0 29.0816-1.1264 43.008-3.3792 13.9264-2.2528 26.5216-6.4512 37.7856-12.5952 11.264-6.144 20.7872-14.5408 28.5696-25.1904a95.744 95.744 0 0 0 15.9744-40.5504h39.936v435.6096z m275.2512-225.4848L552.1408 307.2h70.0416l109.3632 171.4176L845.824 307.2h65.1264l-144.9984 213.1968 154.2144 225.4848H848.896l-117.9648-181.248-121.6512 181.248h-65.1264l152.3712-225.4848z"
            p-id="2639" fill="#ffffff"></path>
        </svg>
        <svg t="1562723140373" v-show="pagePerState===2" viewBox="0 0 1126 1024" version="1.1"
             xmlns="http://www.w3.org/2000/svg" p-id="6031">
          <path
            d="M204.8 51.2a153.6 153.6 0 0 0-153.6 153.6v614.4a153.6 153.6 0 0 0 153.6 153.6h716.8a153.6 153.6 0 0 0 153.6-153.6V204.8a153.6 153.6 0 0 0-153.6-153.6H204.8z m0-51.2h716.8a204.8 204.8 0 0 1 204.8 204.8v614.4a204.8 204.8 0 0 1-204.8 204.8H204.8a204.8 204.8 0 0 1-204.8-204.8V204.8a204.8 204.8 0 0 1 204.8-204.8z"
            p-id="6032" fill="#ffffff"></path>
          <path
            d="M217.088 464.4864a176.128 176.128 0 0 1 6.7584-61.44c5.7344-18.8416 14.6432-35.1232 26.7264-48.8448a125.44 125.44 0 0 1 45.1584-32.256 153.6 153.6 0 0 1 61.44-11.6736c18.8416 0 36.5568 2.7648 53.1456 8.2944 16.5888 5.5296 31.0272 13.5168 43.3152 23.9616 12.288 10.4448 22.016 23.4496 29.184 39.0144 7.168 15.5648 10.752 33.5872 10.752 54.0672 0 19.2512-2.9696 36.2496-8.9088 50.9952-5.9392 14.7456-13.824 27.9552-23.6544 39.6288a198.8608 198.8608 0 0 1-33.792 31.6416c-12.6976 9.4208-25.8048 18.432-39.3216 27.0336-13.5168 8.192-27.0336 16.2816-40.5504 24.2688a319.8976 319.8976 0 0 0-37.1712 25.4976c-11.264 9.0112-20.8896 18.7392-28.8768 29.184a82.5344 82.5344 0 0 0-15.6672 35.9424h223.6416v46.08H204.8c2.048-25.8048 6.656-47.8208 13.824-66.048a176.64 176.64 0 0 1 27.3408-47.616c11.0592-13.5168 23.552-25.3952 37.4784-35.6352 13.9264-10.24 28.4672-19.8656 43.6224-28.8768 18.432-11.4688 34.6112-22.016 48.5376-31.6416 13.9264-9.6256 25.4976-19.3536 34.7136-29.184 9.216-9.8304 16.1792-20.48 20.8896-31.9488 4.7104-11.4688 7.0656-24.7808 7.0656-39.936 0-11.8784-2.2528-22.6304-6.7584-32.256a78.08 78.08 0 0 0-44.8512-40.8576 95.3856 95.3856 0 0 0-32.5632-5.5296c-15.1552 0-28.16 3.1744-39.0144 9.5232a81.8688 81.8688 0 0 0-26.7264 24.8832 103.936 103.936 0 0 0-15.0528 34.7136c-3.072 12.9024-4.4032 25.9072-3.9936 39.0144H217.088z m466.944 55.9104L539.648 307.2h70.0416l109.3632 171.4176L833.3312 307.2h65.1264l-144.9984 213.1968 154.2144 225.4848h-71.2704l-117.9648-181.248-121.6512 181.248h-65.1264l152.3712-225.4848z"
            p-id="6033" fill="#ffffff"></path>
        </svg>
        <svg t="1562723182428" v-show="pagePerState===3" viewBox="0 0 1126 1024" version="1.1"
             xmlns="http://www.w3.org/2000/svg" p-id="7452">
          <path
            d="M204.8 51.2a153.6 153.6 0 0 0-153.6 153.6v614.4a153.6 153.6 0 0 0 153.6 153.6h716.8a153.6 153.6 0 0 0 153.6-153.6V204.8a153.6 153.6 0 0 0-153.6-153.6H204.8z m0-51.2h716.8a204.8 204.8 0 0 1 204.8 204.8v614.4a204.8 204.8 0 0 1-204.8 204.8H204.8a204.8 204.8 0 0 1-204.8-204.8V204.8a204.8 204.8 0 0 1 204.8-204.8z"
            p-id="7453" fill="#ffffff"></path>
          <path
            d="M320.3584 497.0496c2.048 0.4096 3.8912 0.6144 5.5296 0.6144H343.04a107.52 107.52 0 0 0 31.6416-4.608c10.0352-3.072 18.8416-7.5776 26.4192-13.5168 7.5776-5.9392 13.6192-13.4144 18.1248-22.4256 4.5056-9.0112 6.7584-19.2512 6.7584-30.72 0-23.3472-7.3728-40.8576-22.1184-52.5312-14.7456-11.6736-33.1776-17.5104-55.296-17.5104-13.9264 0-26.112 2.56-36.5568 7.68a73.216 73.216 0 0 0-25.8048 20.5824c-6.7584 8.6016-11.776 18.6368-15.0528 30.1056-3.2768 11.4688-4.9152 23.552-4.9152 36.2496H214.016c0.8192-20.8896 4.1984-39.936 10.1376-57.1392 5.9392-17.2032 14.4384-31.9488 25.4976-44.2368 11.0592-12.288 24.8832-21.9136 41.472-28.8768a147.456 147.456 0 0 1 57.4464-10.4448c18.8416 0 36.352 2.3552 52.5312 7.0656 16.1792 4.7104 30.208 11.776 42.0864 21.1968 11.8784 9.4208 21.1968 21.504 27.9552 36.2496 6.7584 14.7456 10.1376 32.1536 10.1376 52.224 0 19.6608-5.7344 37.0688-17.2032 52.224-11.4688 15.1552-25.8048 26.624-43.008 34.4064v1.2288c26.624 5.7344 46.3872 18.2272 59.2896 37.4784 12.9024 19.2512 19.3536 41.984 19.3536 68.1984 0 21.7088-3.9936 40.8576-11.9808 57.4464a120.0128 120.0128 0 0 1-32.256 41.472 137.1136 137.1136 0 0 1-47.616 24.8832 198.9632 198.9632 0 0 1-58.0608 8.2944c-22.1184 0-42.1888-3.072-60.2112-9.216a123.6992 123.6992 0 0 1-46.08-27.3408 119.6544 119.6544 0 0 1-29.184-44.544A158.976 158.976 0 0 1 204.8 611.328h52.224c0.8192 28.2624 9.0112 51.3024 24.576 69.12 15.5648 17.8176 38.2976 26.7264 68.1984 26.7264 12.6976 0 24.7808-1.9456 36.2496-5.8368 11.4688-3.8912 21.504-9.4208 30.1056-16.5888 8.6016-7.168 15.4624-15.9744 20.5824-26.4192 5.12-10.4448 7.68-22.2208 7.68-35.328a79.6672 79.6672 0 0 0-27.0336-62.3616c-8.192-7.168-17.92-12.4928-29.184-15.9744a123.2384 123.2384 0 0 0-36.5568-5.2224c-11.0592 0-21.504 0.6144-31.3344 1.8432v-44.2368z m360.0384 23.3472L536.0128 307.2h70.0416l109.3632 171.4176L829.696 307.2h65.1264l-144.9984 213.1968 154.2144 225.4848h-71.2704l-117.9648-181.248-121.6512 181.248h-65.1264l152.3712-225.4848z"
            p-id="7454" fill="#ffffff"></path>
        </svg>
      </i>
      <i
        title="光标"
        style="margin-top: 3px; float: right;margin-right: 20px"
        @click="handleCursorChange">
        <svg t="1562725360258" v-show="cursorState===1" viewBox="0 0 1024 1024" version="1.1"
             xmlns="http://www.w3.org/2000/svg"
             p-id="21859" width="20" height="20">
          <path
            d="M546.133333 415.402667a102.263467 102.263467 0 0 0-68.266666 0V34.133333a34.133333 34.133333 0 1 1 68.266666 0v381.269334zM415.402667 477.866667a102.263467 102.263467 0 0 0 0 68.266666H34.133333a34.133333 34.133333 0 1 1 0-68.266666h381.269334zM477.866667 608.597333a102.263467 102.263467 0 0 0 68.266666 0V989.866667a34.133333 34.133333 0 1 1-68.266666 0V608.597333zM608.597333 546.133333a102.263467 102.263467 0 0 0 0-68.266666H989.866667a34.133333 34.133333 0 1 1 0 68.266666H608.597333z"
            fill="#ffffff" p-id="21860"></path>
        </svg>
        <svg t="1562725491407" v-show="cursorState===0" viewBox="0 0 1027 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"
             p-id="23256" width="20" height="20">
          <path
            d="M148.931449 733.111311a474.568976 474.568976 0 0 1-32.094186-62.231495l4.146549 9.826394a468.733351 468.733351 0 0 1-32.552775-119.239984l1.470284 10.934357a475.764456 475.764456 0 0 1-0.007002-124.298459l-1.470283 10.934358a467.625387 467.625387 0 0 1 32.239464-118.538099l-4.146549 9.826394a470.02685 470.02685 0 0 1 60.538919-103.688237l-6.430739 8.324605a473.168706 473.168706 0 0 1 84.35576-84.35576l-8.324605 6.43074a470.067108 470.067108 0 0 1 103.688236-60.53892l-9.826394 4.14655a467.625387 467.625387 0 0 1 118.538099-32.239465l-10.934358 1.470284a475.234104 475.234104 0 0 1 124.238948 0l-10.934357-1.470284a467.625387 467.625387 0 0 1 118.538098 32.239465l-9.824643-4.14655a469.986592 469.986592 0 0 1 103.688236 60.53892l-8.324605-6.43074a473.168706 473.168706 0 0 1 84.35576 84.35576l-6.432489-8.324605a470.067108 470.067108 0 0 1 60.538919 103.688237l-4.14655-9.826394a467.551873 467.551873 0 0 1 32.239465 118.538099l-1.468533-10.934358a475.386383 475.386383 0 0 1 0 124.238948l1.468533-10.934358a467.551873 467.551873 0 0 1-32.239465 118.538099l4.14655-9.824644a469.986592 469.986592 0 0 1-60.538919 103.688237l6.432489-8.324605a473.226467 473.226467 0 0 1-84.35576 84.35576l8.324605-6.43249a470.067108 470.067108 0 0 1-103.688236 60.538919l9.824643-4.146549a467.513366 467.513366 0 0 1-118.538098 32.239464l10.934357-1.468533a475.776708 475.776708 0 0 1-125.233139-0.133025l10.934357 1.468533a468.691343 468.691343 0 0 1-117.941233-32.272721l9.826394 4.146549A472.56659 472.56659 0 0 1 272.82558 862.216197c-18.691853-12.434397-45.44401-3.73697-56.276847 14.757094-5.564323 9.500831-7.067862 21.079313-4.14655 31.69511 2.961571 10.768076 9.793138 18.52207 18.903644 24.583488 90.653474 60.299123 201.65287 89.722294 310.275307 82.654432 89.676786-5.835625 177.653994-34.905228 252.015327-85.642258 72.483222-49.455783 132.684326-117.083568 171.202251-196.111301 40.010962-82.092574 58.284485-174.449126 50.32745-265.596195-7.803004-89.403733-38.201113-176.476017-90.452185-249.710133-51.020584-71.510034-119.443023-130.506906-199.42819-167.402268C642.136267 13.108277 549.543419-3.63195 458.315834 6.364227c-45.18671 4.951704-89.352973 14.832359-131.641124 31.658352-41.176687 16.384908-80.130446 37.023136-115.704303 63.544249-35.253545 26.283066-67.342481 55.958286-94.754514 90.413677-27.534557 34.611171-51.09935 71.664064-68.788259 112.270141-18.063482 41.465493-31.390551 84.266493-37.810789 129.111887-3.52868 24.655252-5.921391 49.308755-6.092924 74.228308-0.21004 30.219575 2.847799 60.323628 7.725989 90.124872 10.197466 62.317262 33.678242 123.137985 66.645846 176.917102 11.695754 19.078678 36.62931 26.265563 56.276848 14.757094 19.029668-11.146148 26.484355-37.149161 14.758845-56.278598z"
            p-id="23257" fill="#ffffff"></path>
          <path
            d="M317.163377 551.356277h386.154183c22.423572 0 41.132929-18.709356 41.132928-41.132929s-18.709356-41.132929-41.132928-41.132928H317.163377c-22.423572 0-41.132929 18.709356-41.132929 41.132928s18.711107 41.132929 41.132929 41.132929z"
            p-id="23258" fill="#ffffff"></path>
        </svg>
      </i>
    </div>
  </div>
</template>

<script>
  import $ from 'jquery'

  export default {
    name: "HHScoreController",
    props: {
      currentProgress: Number,
      maxProgress: Number,//时间的ms值，自动转换时间并显示
      controllerWidth: Number,//时间的ms值，自动转换时间并显示
      controllerHeight: Number,//时间的ms值，自动转换时间并显示
      timeTextValue: String,//时间的ms值，自动转换时间并显示
      hideState: Boolean,
      playStateValue: Boolean,
      directionStateValue: Number,
      pagePerStateValue: Number,
      cursorStateValue: Boolean,
      fullStateValue: Boolean,
    },
    data() {
      return {
        playState: this.playStateValue?1:0,
        fullState: this.fullStateValue?1:0,
        timeText: this.timeTextValue,
        directionState: this.directionStateValue,
        pagePerState: this.pagePerStateValue,
        cursorState: this.cursorStateValue?1:0,
        slider: null,        //滚动条DOM元素
        thunk: null,         //拖拽DOM元素
        progress: 0,
        max: this.maxProgress,
        min: 0,
        isOnSeek: false,
      }
    },
    watch: {
      fullStateValue(val) {
        if (val) {
          this.fullState = 1;
        } else {
          this.fullState = 0;
        }
      },
      currentProgress(val) {
        if (!this.isOnSeek) {
          this.progress = val;
        }
      },
      maxProgress(val) {
        this.max = val;
      },
      timeTextValue(val) {
        this.timeText = val;
      },
      hideState(val) {
        if (val) {//隐藏
          $(this.$refs.container).slideUp();
        } else {//显示
          $(this.$refs.container).slideDown();
        }
      },
      playStateValue(val) {
        if (val) {
          this.playState = 1;
        } else {
          this.playState = 0;
        }
      }
    },
    mounted() {
      this.slider = this.$refs.slider;
      this.thunk = this.$refs.trunk;
      let _this = this;
      this.slider.onclick = function (e) {
        let left = $(_this.slider).offset().left;
        let newWidth = e.clientX - left;
        if (newWidth <= 0 || newWidth >= _this.seekWidth) {
          return;
        }else {
          let scale = newWidth / _this.slider.offsetWidth;
          _this.progress = Math.ceil((_this.max - _this.min) * scale + _this.min);
          _this.progress = Math.max(_this.progress, _this.min);
          _this.progress = Math.min(_this.progress, _this.max);
          _this.$emit("onProgressChanged", _this.progress);
        }
      };
      this.thunk.onmousedown = function (e) {
        let width = parseInt(_this.seekWidth);
        let disX = e.clientX;
        document.onmousemove = function (e) {
          _this.isOnSeek = true;
          // value, left, width
          // 当value变化的时候，会通过计算属性修改left，width

          // 拖拽的时候获取的新width
          let newWidth = e.clientX - disX + width;
          // 拖拽的时候得到新的百分比
          let scale = newWidth / _this.slider.offsetWidth;
          _this.progress = Math.ceil((_this.max - _this.min) * scale + _this.min);
          _this.progress = Math.max(_this.progress, _this.min);
          _this.progress = Math.min(_this.progress, _this.max);
        };
        document.onmouseup = function () {
          _this.isOnSeek = false;
          _this.$emit("onProgressChanged", _this.progress);
          document.onmousemove = document.onmouseup = null;
        };
        return false;
      }

    },
    methods: {
      handlePlay() {
        this.$emit("onPlayStateChanged", this.playState);
      },
      handleStop() {
        this.$emit("onStop");
      },
      handleFullScreen() {
        if (this.fullState === 0) {
          this.fullState = 1;
        } else {
          this.fullState = 0;
        }
        this.$emit("onFullStateChanged", this.fullState);
      },
      handleDirectionChange() {
        if (this.directionState === 0) {
          this.directionState = 1;
        } else {
          this.directionState = 0;
        }
        this.$emit("onDirectionStateChanged", this.directionState);
      },
      handlePagePerChange() {
        if (this.pagePerState === 1) {
          this.pagePerState = 2;
        } else if (this.pagePerState === 2) {
          this.pagePerState = 3;
        } else {
          this.pagePerState = 1;
        }
        this.$emit("onPagePerStateChanged", this.pagePerState);
      },
      handleCursorChange() {
        if (this.cursorState === 0) {
          this.cursorState = 1;
        } else {
          this.cursorState = 0;
        }
        this.$emit("onCursorStateChanged", this.cursorState);
      },
    },
    computed: {
      scale() {
        return (this.progress - this.min) / (this.max - this.min);
      },
      seekWidth() {
        if (this.slider) {
          return this.slider.offsetWidth * this.scale + 'px';
        } else {
          return 0 + 'px'
        }
      },
      left() {
        if (this.slider) {
          return this.slider.offsetWidth * this.scale - this.thunk.offsetWidth / 2 + 'px';
        } else {
          return 0 + 'px'
        }
      }
    }
  }
</script>

<style scoped>
  /*进度条组件*/
  .con-slider {
    position: relative;
    margin: 20px 20px;
    width: auto;
    height: 5px;
    padding-right: 10px;
    background: #e4e7ed;
    border-radius: 5px;
    cursor: pointer;
    box-sizing: content-box;
  }

  .con-slider:after{
    box-sizing: content-box;
  }
  .con-slider:before{
    box-sizing: content-box;
  }

  .con-slider .process {
    position: absolute;
    left: 0;
    top: 0;
    width: 112px;
    height: 5px;
    border-radius: 5px;
    background: #409eff
  }

  .con-slider .thunk {
    position: absolute;
    left: 100px;
    top: -4px;
    width: 10px;
    height: 10px
  }

  .con-slider .btn-circle {
    width: 10px;
    height: 10px;
    border-radius: 50%;
    border: 2px solid #409eff;
    background: rgba(255, 255, 255, 1);
    transition: .2s all;
    box-sizing: content-box;
  }
  .con-slider .btn-circle:after,:before{
    box-sizing: content-box;
  }

  .con-slider .btn-circle:hover {
    transform: scale(1.1);
    opacity: .6
  }

  .controller-container{
    position: relative;
  }

  .score-controller {
    background-color: rgba(0, 0, 0, 0.8);
    position: relative;
    padding-top: 3px;
    z-index: 20;
  }

  .time {
    font-size: 15px;
    color: #EEEEEE;
  }


  .hide {
    display: none;
  }



</style>
